{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 135, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/chat/message-bubble.tsx"],"sourcesContent":["\"use client\"\n\nimport { Bot, User, Sparkles } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport type { ChatMessage } from \"@/lib/mock-data\"\nimport ReactMarkdown from \"react-markdown\"\n\ninterface MessageBubbleProps {\n  message: ChatMessage\n  isStreaming?: boolean\n}\n\nexport function MessageBubble({ message, isStreaming }: MessageBubbleProps) {\n  const isAI = message.role === \"ai\"\n\n  return (\n    <div className={cn(\"flex gap-3 mb-4\", isAI ? \"justify-start\" : \"justify-end\")}>\n      {isAI && (\n        <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0\">\n          {isStreaming ? (\n            <Sparkles className=\"w-4 h-4 text-white animate-pulse\" />\n          ) : (\n            <Bot className=\"w-4 h-4 text-white\" />\n          )}\n        </div>\n      )}\n      <div\n        className={cn(\n          \"max-w-[80%] px-4 py-3 rounded-2xl\",\n          isAI ? \"bg-gray-100 text-gray-900 rounded-tl-sm\" : \"bg-blue-600 text-white rounded-tr-sm\",\n        )}\n      >\n        {isAI ? (\n          <div className=\"text-sm leading-relaxed prose prose-sm prose-gray max-w-none\">\n            <ReactMarkdown\n              components={{\n                p: ({ children }) => <p className=\"mb-2 last:mb-0\">{children}</p>,\n                ul: ({ children }) => <ul className=\"list-disc pl-4 mb-2 space-y-1\">{children}</ul>,\n                ol: ({ children }) => <ol className=\"list-decimal pl-4 mb-2 space-y-1\">{children}</ol>,\n                li: ({ children }) => <li className=\"text-sm\">{children}</li>,\n                strong: ({ children }) => <strong className=\"font-semibold\">{children}</strong>,\n              }}\n            >\n              {message.content}\n            </ReactMarkdown>\n            {isStreaming && <span className=\"inline-block w-2 h-4 bg-blue-600 animate-pulse ml-0.5\" />}\n          </div>\n        ) : (\n          <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{message.content}</p>\n        )}\n      </div>\n      {!isAI && (\n        <div className=\"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0\">\n          <User className=\"w-4 h-4 text-gray-600\" />\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AACA;AAEA;AALA;;;;;AAYO,SAAS,cAAc,EAAE,OAAO,EAAE,WAAW,EAAsB;IACxE,MAAM,OAAO,QAAQ,IAAI,KAAK;IAE9B,qBACE,8OAAC;QAAI,WAAW,IAAA,kHAAE,EAAC,mBAAmB,OAAO,kBAAkB;;YAC5D,sBACC,8OAAC;gBAAI,WAAU;0BACZ,4BACC,8OAAC,sNAAQ;oBAAC,WAAU;;;;;yCAEpB,8OAAC,uMAAG;oBAAC,WAAU;;;;;;;;;;;0BAIrB,8OAAC;gBACC,WAAW,IAAA,kHAAE,EACX,qCACA,OAAO,4CAA4C;0BAGpD,qBACC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,mMAAa;4BACZ,YAAY;gCACV,GAAG,CAAC,EAAE,QAAQ,EAAE,iBAAK,8OAAC;wCAAE,WAAU;kDAAkB;;;;;;gCACpD,IAAI,CAAC,EAAE,QAAQ,EAAE,iBAAK,8OAAC;wCAAG,WAAU;kDAAiC;;;;;;gCACrE,IAAI,CAAC,EAAE,QAAQ,EAAE,iBAAK,8OAAC;wCAAG,WAAU;kDAAoC;;;;;;gCACxE,IAAI,CAAC,EAAE,QAAQ,EAAE,iBAAK,8OAAC;wCAAG,WAAU;kDAAW;;;;;;gCAC/C,QAAQ,CAAC,EAAE,QAAQ,EAAE,iBAAK,8OAAC;wCAAO,WAAU;kDAAiB;;;;;;4BAC/D;sCAEC,QAAQ,OAAO;;;;;;wBAEjB,6BAAe,8OAAC;4BAAK,WAAU;;;;;;;;;;;yCAGlC,8OAAC;oBAAE,WAAU;8BAA+C,QAAQ,OAAO;;;;;;;;;;;YAG9E,CAAC,sBACA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC,0MAAI;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAK1B"}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/chat/typing-indicator.tsx"],"sourcesContent":["export function TypingIndicator() {\n  return (\n    <div className=\"flex gap-3 mb-4\">\n      <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0\">\n        <div className=\"flex gap-1\">\n          <div className=\"w-1.5 h-1.5 bg-white rounded-full animate-bounce\" style={{ animationDelay: \"0ms\" }} />\n          <div className=\"w-1.5 h-1.5 bg-white rounded-full animate-bounce\" style={{ animationDelay: \"150ms\" }} />\n          <div className=\"w-1.5 h-1.5 bg-white rounded-full animate-bounce\" style={{ animationDelay: \"300ms\" }} />\n        </div>\n      </div>\n      <div className=\"bg-gray-100 rounded-2xl rounded-tl-sm px-4 py-3\">\n        <div className=\"flex gap-1\">\n          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"0ms\" }} />\n          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"150ms\" }} />\n          <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"300ms\" }} />\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS;IACd,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;4BAAmD,OAAO;gCAAE,gBAAgB;4BAAM;;;;;;sCACjG,8OAAC;4BAAI,WAAU;4BAAmD,OAAO;gCAAE,gBAAgB;4BAAQ;;;;;;sCACnG,8OAAC;4BAAI,WAAU;4BAAmD,OAAO;gCAAE,gBAAgB;4BAAQ;;;;;;;;;;;;;;;;;0BAGvG,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;4BAAkD,OAAO;gCAAE,gBAAgB;4BAAM;;;;;;sCAChG,8OAAC;4BAAI,WAAU;4BAAkD,OAAO;gCAAE,gBAAgB;4BAAQ;;;;;;sCAClG,8OAAC;4BAAI,WAAU;4BAAkD,OAAO;gCAAE,gBAAgB;4BAAQ;;;;;;;;;;;;;;;;;;;;;;;AAK5G"}},
    {"offset": {"line": 392, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/chat/chat-input.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState, useRef, useEffect } from \"react\"\nimport { Send } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\n\ninterface ChatInputProps {\n  onSend: (message: string) => void\n  disabled?: boolean\n}\n\nexport function ChatInput({ onSend, disabled }: ChatInputProps) {\n  const [message, setMessage] = useState(\"\")\n  const textareaRef = useRef<HTMLTextAreaElement>(null)\n\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = \"auto\"\n      textareaRef.current.style.height = `${Math.min(textareaRef.current.scrollHeight, 120)}px`\n    }\n  }, [message])\n\n  const handleSubmit = () => {\n    if (message.trim() && !disabled) {\n      onSend(message.trim())\n      setMessage(\"\")\n    }\n  }\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault()\n      handleSubmit()\n    }\n  }\n\n  return (\n    <div className=\"border-t border-gray-200 bg-white p-4\">\n      <div className=\"flex gap-3 items-end\">\n        <textarea\n          ref={textareaRef}\n          value={message}\n          onChange={(e) => setMessage(e.target.value)}\n          onKeyDown={handleKeyDown}\n          placeholder=\"Type your response here...\"\n          disabled={disabled}\n          className=\"flex-1 resize-none border border-gray-300 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 min-h-[48px] max-h-[120px]\"\n          rows={1}\n        />\n        <Button\n          onClick={handleSubmit}\n          disabled={!message.trim() || disabled}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white h-12 w-12 rounded-xl p-0\"\n        >\n          <Send className=\"w-5 h-5\" />\n        </Button>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAIA;AACA;AACA;AANA;;;;;AAaO,SAAS,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAkB;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,cAAc,IAAA,+MAAM,EAAsB;IAEhD,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY,OAAO,EAAE;YACvB,YAAY,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG;YACnC,YAAY,OAAO,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,KAAK,GAAG,CAAC,YAAY,OAAO,CAAC,YAAY,EAAE,KAAK,EAAE,CAAC;QAC3F;IACF,GAAG;QAAC;KAAQ;IAEZ,MAAM,eAAe;QACnB,IAAI,QAAQ,IAAI,MAAM,CAAC,UAAU;YAC/B,OAAO,QAAQ,IAAI;YACnB,WAAW;QACb;IACF;IAEA,MAAM,gBAAgB,CAAC;QACrB,IAAI,EAAE,GAAG,KAAK,WAAW,CAAC,EAAE,QAAQ,EAAE;YACpC,EAAE,cAAc;YAChB;QACF;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBACC,KAAK;oBACL,OAAO;oBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;oBAC1C,WAAW;oBACX,aAAY;oBACZ,UAAU;oBACV,WAAU;oBACV,MAAM;;;;;;8BAER,8OAAC,qIAAM;oBACL,SAAS;oBACT,UAAU,CAAC,QAAQ,IAAI,MAAM;oBAC7B,WAAU;8BAEV,cAAA,8OAAC,0MAAI;wBAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;AAK1B"}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/ui/scroll-area.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'\n\nimport { cn } from '@/lib/utils'\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn('relative', className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = 'vertical',\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        'flex touch-none p-px transition-colors select-none',\n        orientation === 'vertical' &&\n          'h-full w-2.5 border-l border-l-transparent',\n        orientation === 'horizontal' &&\n          'h-2.5 flex-col border-t border-t-transparent',\n        className,\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,8OAAC,kLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,8OAAC,sLAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,8OAAC;;;;;0BACD,8OAAC,oLAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,8OAAC,iMAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,kHAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,6LAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 549, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/chat/phase-indicator.tsx"],"sourcesContent":["\"use client\"\n\n// =============================================================================\n// STEPWISE - PHASE INDICATOR\n// Visual progress indicator for the 5-phase conversation flow\n// =============================================================================\n\nimport { CheckCircle2, Circle, Loader2 } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { CONVERSATION_PHASES, type ConversationPhase } from \"@/lib/types\"\n\n// -----------------------------------------------------------------------------\n// Types\n// -----------------------------------------------------------------------------\n\ninterface PhaseIndicatorProps {\n    currentPhase: ConversationPhase\n    progress: number // 0-100 overall progress\n    className?: string\n    variant?: \"compact\" | \"detailed\"\n}\n\n// -----------------------------------------------------------------------------\n// Phase Configuration\n// -----------------------------------------------------------------------------\n\nconst PHASE_ORDER: ConversationPhase[] = [\n    \"foundation\",\n    \"process\",\n    \"accountability\",\n    \"quality\",\n    \"finalization\",\n]\n\n// -----------------------------------------------------------------------------\n// Component\n// -----------------------------------------------------------------------------\n\nexport function PhaseIndicator({\n    currentPhase,\n    progress,\n    className,\n    variant = \"compact\",\n}: PhaseIndicatorProps) {\n    const currentIndex = PHASE_ORDER.indexOf(currentPhase)\n\n    if (variant === \"compact\") {\n        return (\n            <div className={cn(\"flex items-center gap-2\", className)}>\n                {/* Phase Pills */}\n                <div className=\"flex items-center gap-1\">\n                    {PHASE_ORDER.map((phase, index) => {\n                        const isComplete = index < currentIndex\n                        const isCurrent = index === currentIndex\n                        const isPending = index > currentIndex\n\n                        return (\n                            <div\n                                key={phase}\n                                className={cn(\n                                    \"h-2 rounded-full transition-all duration-300\",\n                                    index === 0 ? \"w-8\" : \"w-6\",\n                                    isComplete && \"bg-emerald-500\",\n                                    isCurrent && \"bg-blue-600\",\n                                    isPending && \"bg-slate-200\"\n                                )}\n                                title={CONVERSATION_PHASES[phase].name}\n                            />\n                        )\n                    })}\n                </div>\n\n                {/* Current Phase Label */}\n                <span className=\"text-xs font-medium text-slate-600\">\n                    {CONVERSATION_PHASES[currentPhase].name}\n                </span>\n\n                {/* Progress Percentage */}\n                <span className=\"text-xs text-slate-400\">\n                    {Math.round(progress)}%\n                </span>\n            </div>\n        )\n    }\n\n    // Detailed variant\n    return (\n        <div className={cn(\"space-y-4\", className)}>\n            {/* Overall Progress Bar */}\n            <div className=\"space-y-1\">\n                <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"font-medium text-slate-900\">\n                        {CONVERSATION_PHASES[currentPhase].name}\n                    </span>\n                    <span className=\"text-slate-500\">{Math.round(progress)}% complete</span>\n                </div>\n                <div className=\"h-2 bg-slate-100 rounded-full overflow-hidden\">\n                    <div\n                        className=\"h-full bg-blue-600 rounded-full transition-all duration-500 ease-out\"\n                        style={{ width: `${progress}%` }}\n                    />\n                </div>\n            </div>\n\n            {/* Phase Steps */}\n            <div className=\"space-y-2\">\n                {PHASE_ORDER.map((phase, index) => {\n                    const phaseInfo = CONVERSATION_PHASES[phase]\n                    const isComplete = index < currentIndex\n                    const isCurrent = index === currentIndex\n                    const isPending = index > currentIndex\n\n                    return (\n                        <div\n                            key={phase}\n                            className={cn(\n                                \"flex items-center gap-3 p-2 rounded-lg transition-colors\",\n                                isCurrent && \"bg-blue-50\",\n                                isComplete && \"bg-emerald-50/50\"\n                            )}\n                        >\n                            {/* Icon */}\n                            <div\n                                className={cn(\n                                    \"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0\",\n                                    isComplete && \"bg-emerald-500 text-white\",\n                                    isCurrent && \"bg-blue-600 text-white\",\n                                    isPending && \"bg-slate-200 text-slate-400\"\n                                )}\n                            >\n                                {isComplete ? (\n                                    <CheckCircle2 className=\"w-4 h-4\" />\n                                ) : isCurrent ? (\n                                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                                ) : (\n                                    <Circle className=\"w-3 h-3\" />\n                                )}\n                            </div>\n\n                            {/* Text */}\n                            <div className=\"flex-1 min-w-0\">\n                                <div\n                                    className={cn(\n                                        \"text-sm font-medium truncate\",\n                                        isComplete && \"text-emerald-700\",\n                                        isCurrent && \"text-blue-700\",\n                                        isPending && \"text-slate-400\"\n                                    )}\n                                >\n                                    {phaseInfo.name}\n                                </div>\n                                <div\n                                    className={cn(\n                                        \"text-xs truncate\",\n                                        isComplete && \"text-emerald-600/70\",\n                                        isCurrent && \"text-blue-600/70\",\n                                        isPending && \"text-slate-400\"\n                                    )}\n                                >\n                                    {phaseInfo.description}\n                                </div>\n                            </div>\n\n                            {/* Status */}\n                            {isComplete && (\n                                <span className=\"text-xs font-medium text-emerald-600\">Done</span>\n                            )}\n                            {isCurrent && (\n                                <span className=\"text-xs font-medium text-blue-600\">In Progress</span>\n                            )}\n                        </div>\n                    )\n                })}\n            </div>\n        </div>\n    )\n}\n\n// -----------------------------------------------------------------------------\n// Mini Phase Badge (for header)\n// -----------------------------------------------------------------------------\n\ninterface PhaseBadgeProps {\n    phase: ConversationPhase\n    progress: number\n    className?: string\n}\n\nexport function PhaseBadge({ phase, progress, className }: PhaseBadgeProps) {\n    return (\n        <div\n            className={cn(\n                \"inline-flex items-center gap-2 px-3 py-1.5 rounded-full\",\n                \"bg-blue-50 border border-blue-200\",\n                className\n            )}\n        >\n            <div className=\"w-2 h-2 rounded-full bg-blue-600 animate-pulse\" />\n            <span className=\"text-xs font-medium text-blue-700\">\n                {CONVERSATION_PHASES[phase].name}\n            </span>\n            <span className=\"text-xs text-blue-500\">{Math.round(progress)}%</span>\n        </div>\n    )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 827, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/notes/notes-panel.tsx"],"sourcesContent":["\"use client\"\n\n// =============================================================================\n// STEPWISE - ENHANCED NOTES PANEL\n// Displays categorized notes with priority indicators\n// =============================================================================\n\nimport { useState, useMemo } from \"react\"\nimport { FileEdit, Trash2, ChevronDown, ChevronRight, Sparkles } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { cn } from \"@/lib/utils\"\nimport {\n  type Note,\n  type NoteCategory,\n  CATEGORY_STYLES,\n  PRIORITY_STYLES,\n  NOTE_CATEGORIES,\n} from \"@/lib/types\"\nimport { PhaseIndicator } from \"@/components/chat/phase-indicator\"\nimport type { ConversationPhase } from \"@/lib/types\"\n\n// -----------------------------------------------------------------------------\n// Types\n// -----------------------------------------------------------------------------\n\ninterface NotesPanelProps {\n  notes: Note[]\n  onDeleteNote?: (id: string) => void\n  onEditNote?: (note: Note) => void\n  onReview?: () => void\n  progress: number\n  phase: ConversationPhase | string\n}\n\n// -----------------------------------------------------------------------------\n// Note Card Component\n// -----------------------------------------------------------------------------\n\nfunction NoteCard({\n  note,\n  onDelete,\n  onEdit,\n}: {\n  note: Note\n  onDelete?: () => void\n  onEdit?: () => void\n}) {\n  const categoryStyle = CATEGORY_STYLES[note.category] || CATEGORY_STYLES.METADATA\n  const priorityStyle = PRIORITY_STYLES[note.priority]\n\n  return (\n    <div className=\"bg-white rounded-lg border border-slate-200 p-3 hover:shadow-sm transition-shadow\">\n      {/* Header */}\n      <div className=\"flex items-start justify-between gap-2 mb-2\">\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <span\n            className={cn(\n              \"px-2 py-0.5 rounded text-xs font-medium\",\n              categoryStyle.bg,\n              categoryStyle.text\n            )}\n          >\n            {categoryStyle.label}\n          </span>\n          <span className={cn(\"text-sm font-bold\", priorityStyle.color)}>\n            {priorityStyle.icon}\n          </span>\n        </div>\n        <span className=\"text-xs text-slate-400 whitespace-nowrap\">\n          {note.timestamp}\n        </span>\n      </div>\n\n      {/* Content */}\n      <p className=\"text-sm text-slate-700 mb-2 line-clamp-3\">{note.content}</p>\n\n      {/* Related To */}\n      {note.relatedTo && (\n        <p className=\"text-xs text-slate-500 mb-2\">\n          <span className=\"font-medium\">â†’</span> {note.relatedTo}\n        </p>\n      )}\n\n      {/* Actions */}\n      <div className=\"flex items-center justify-between pt-2 border-t border-slate-100\">\n        <span className=\"text-xs text-slate-400\">{note.source}</span>\n        <div className=\"flex items-center gap-1\">\n          {onEdit && (\n            <button\n              onClick={onEdit}\n              className=\"p-1 text-slate-400 hover:text-slate-600 transition-colors\"\n              title=\"Edit note\"\n            >\n              <FileEdit className=\"w-3.5 h-3.5\" />\n            </button>\n          )}\n          {onDelete && (\n            <button\n              onClick={onDelete}\n              className=\"p-1 text-slate-400 hover:text-red-500 transition-colors\"\n              title=\"Delete note\"\n            >\n              <Trash2 className=\"w-3.5 h-3.5\" />\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Category Group Component\n// -----------------------------------------------------------------------------\n\nfunction CategoryGroup({\n  category,\n  notes,\n  onDeleteNote,\n  onEditNote,\n  defaultExpanded = true,\n}: {\n  category: NoteCategory\n  notes: Note[]\n  onDeleteNote?: (id: string) => void\n  onEditNote?: (note: Note) => void\n  defaultExpanded?: boolean\n}) {\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded)\n  const categoryStyle = CATEGORY_STYLES[category]\n\n  return (\n    <div className=\"space-y-2\">\n      {/* Category Header */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        className=\"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 transition-colors\"\n      >\n        <div className=\"flex items-center gap-2\">\n          {isExpanded ? (\n            <ChevronDown className=\"w-4 h-4 text-slate-400\" />\n          ) : (\n            <ChevronRight className=\"w-4 h-4 text-slate-400\" />\n          )}\n          <span\n            className={cn(\n              \"px-2 py-0.5 rounded text-xs font-medium\",\n              categoryStyle.bg,\n              categoryStyle.text\n            )}\n          >\n            {categoryStyle.label}\n          </span>\n        </div>\n        <span className=\"text-xs text-slate-400\">{notes.length}</span>\n      </button>\n\n      {/* Notes */}\n      {isExpanded && (\n        <div className=\"space-y-2 pl-6\">\n          {notes.map((note) => (\n            <NoteCard\n              key={note.id}\n              note={note}\n              onDelete={onDeleteNote ? () => onDeleteNote(note.id) : undefined}\n              onEdit={onEditNote ? () => onEditNote(note) : undefined}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Main Notes Panel\n// -----------------------------------------------------------------------------\n\nexport function NotesPanel({\n  notes,\n  onDeleteNote,\n  onEditNote,\n  onReview,\n  progress,\n  phase,\n}: NotesPanelProps) {\n  const [viewMode, setViewMode] = useState<\"grouped\" | \"list\">(\"grouped\")\n\n  // Group notes by category\n  const groupedNotes = useMemo(() => {\n    const groups: Partial<Record<NoteCategory, Note[]>> = {}\n\n    for (const note of notes) {\n      if (!groups[note.category]) {\n        groups[note.category] = []\n      }\n      groups[note.category]!.push(note)\n    }\n\n    return groups\n  }, [notes])\n\n  // Order categories by priority (procedure steps first, etc.)\n  const categoryOrder: NoteCategory[] = [\n    \"HEADER_INFO\",\n    \"PURPOSE_SCOPE\",\n    \"ROLES_RESPONSIBILITIES\",\n    \"PROCEDURE_STEPS\",\n    \"DECISION_POINTS\",\n    \"QUALITY_SUCCESS\",\n    \"TROUBLESHOOTING\",\n    \"MATERIALS_RESOURCES\",\n    \"DEFINITIONS_REFERENCES\",\n    \"VISUAL_AIDS\",\n    \"GAPS_IMPROVEMENTS\",\n    \"METADATA\",\n  ]\n\n  const sortedCategories = categoryOrder.filter(\n    (cat) => groupedNotes[cat] && groupedNotes[cat]!.length > 0\n  )\n\n  // Convert phase string to ConversationPhase type\n  const normalizedPhase = (phase as ConversationPhase) || \"foundation\"\n\n  return (\n    <div className=\"h-full flex flex-col bg-slate-50\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-slate-200 bg-white\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-slate-900\">Extracted Notes</h3>\n          <span className=\"text-sm text-slate-500\">{notes.length} notes</span>\n        </div>\n\n        {/* Phase Progress */}\n        <PhaseIndicator\n          currentPhase={normalizedPhase}\n          progress={progress}\n          variant=\"compact\"\n        />\n      </div>\n\n      {/* Notes Content */}\n      <ScrollArea className=\"flex-1 p-4\">\n        {notes.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <div className=\"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3\">\n              <FileEdit className=\"w-6 h-6 text-slate-400\" />\n            </div>\n            <p className=\"text-sm text-slate-500 mb-1\">No notes yet</p>\n            <p className=\"text-xs text-slate-400\">\n              Notes will appear here as you chat with the AI\n            </p>\n          </div>\n        ) : viewMode === \"grouped\" ? (\n          <div className=\"space-y-4\">\n            {sortedCategories.map((category) => (\n              <CategoryGroup\n                key={category}\n                category={category}\n                notes={groupedNotes[category]!}\n                onDeleteNote={onDeleteNote}\n                onEditNote={onEditNote}\n                defaultExpanded={true}\n              />\n            ))}\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {notes.map((note) => (\n              <NoteCard\n                key={note.id}\n                note={note}\n                onDelete={onDeleteNote ? () => onDeleteNote(note.id) : undefined}\n                onEdit={onEditNote ? () => onEditNote(note) : undefined}\n              />\n            ))}\n          </div>\n        )}\n      </ScrollArea>\n\n      {/* Footer Actions */}\n      <div className=\"p-4 border-t border-slate-200 bg-white\">\n        <div className=\"flex items-center gap-2 mb-3\">\n          <button\n            onClick={() => setViewMode(\"grouped\")}\n            className={cn(\n              \"flex-1 py-1.5 text-xs font-medium rounded transition-colors\",\n              viewMode === \"grouped\"\n                ? \"bg-blue-100 text-blue-700\"\n                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\n            )}\n          >\n            By Category\n          </button>\n          <button\n            onClick={() => setViewMode(\"list\")}\n            className={cn(\n              \"flex-1 py-1.5 text-xs font-medium rounded transition-colors\",\n              viewMode === \"list\"\n                ? \"bg-blue-100 text-blue-700\"\n                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\n            )}\n          >\n            All Notes\n          </button>\n        </div>\n\n        <Button\n          onClick={onReview}\n          disabled={notes.length === 0}\n          className=\"w-full bg-blue-600 hover:bg-blue-700 text-white gap-2\"\n        >\n          <Sparkles className=\"w-4 h-4\" />\n          Review & Generate SOP\n        </Button>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1305, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/app/create/page.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\n\nimport { useState, useRef, useEffect } from \"react\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/navigation\"\nimport { useChat } from \"@ai-sdk/react\"\nimport { ArrowLeft, Save, FileEdit, MessageSquare } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { MessageBubble } from \"@/components/chat/message-bubble\"\nimport { TypingIndicator } from \"@/components/chat/typing-indicator\"\nimport { ChatInput } from \"@/components/chat/chat-input\"\nimport { NotesPanel } from \"@/components/notes/notes-panel\"\nimport { useSOPContext } from \"@/lib/sop-context\"\nimport type { Note, SOP } from \"@/lib/mock-data\"\nimport { cn } from \"@/lib/utils\"\n\nfunction parseAIResponse(content: string): { message: string; notes: Note[]; phase: string; progress: number } {\n  try {\n    // Try to parse as JSON first\n    const parsed = JSON.parse(content)\n    const notes: Note[] = (parsed.notes || []).map((n: any, idx: number) => ({\n      id: `note-${Date.now()}-${idx}`,\n      category: n.category || \"OTHER\",\n      priority: n.priority || \"medium\",\n      timestamp: new Date().toLocaleTimeString(),\n      source: \"AI Extraction\",\n      content: n.content || \"\",\n      relatedTo: n.relatedTo || \"\",\n      action: n.action || \"\",\n    }))\n    return {\n      message: parsed.message || content,\n      notes,\n      phase: parsed.phase || \"foundation\",\n      progress: parsed.progress || 0,\n    }\n  } catch {\n    // If not JSON, return as plain message\n    return { message: content, notes: [], phase: \"foundation\", progress: 0 }\n  }\n}\n\nexport default function CreateSOPPage() {\n  const router = useRouter()\n  const { addSOP } = useSOPContext()\n  const [notes, setNotes] = useState<Note[]>([])\n  const [currentPhase, setCurrentPhase] = useState(\"foundation\")\n  const [progress, setProgress] = useState(0)\n  const [activeTab, setActiveTab] = useState<\"chat\" | \"notes\">(\"chat\")\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n\n  const { messages, input, handleInputChange, handleSubmit, isLoading, setMessages } = useChat({\n    api: \"/api/chat/sop\",\n    initialMessages: [\n      {\n        id: \"initial\",\n        role: \"assistant\",\n        content: JSON.stringify({\n          message:\n            \"Hello! I'm here to help you create a professional SOP. Let's start with the basics.\\n\\nWhat process or procedure would you like to document today?\",\n          notes: [],\n          phase: \"foundation\",\n          progress: 0,\n        }),\n      },\n    ],\n    onFinish: (message) => {\n      // Extract notes from completed AI response\n      const parsed = parseAIResponse(message.content)\n      if (parsed.notes.length > 0) {\n        setNotes((prev) => [...prev, ...parsed.notes])\n      }\n      if (parsed.phase) {\n        setCurrentPhase(parsed.phase)\n      }\n      if (parsed.progress) {\n        setProgress(parsed.progress)\n      }\n    },\n  })\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n  }\n\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages, isLoading])\n\n  const getDisplayMessage = (content: string) => {\n    try {\n      const parsed = JSON.parse(content)\n      return parsed.message || content\n    } catch {\n      return content\n    }\n  }\n\n  const handleSaveDraft = () => {\n    const newSOP: SOP = {\n      id: `sop-${Date.now()}`,\n      title: \"New SOP Draft\",\n      department: \"General\",\n      status: \"draft\",\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      content: \"\",\n      notes,\n      chatHistory: messages.map((m) => ({\n        id: m.id,\n        role: m.role === \"assistant\" ? \"ai\" : \"user\",\n        content: getDisplayMessage(m.content),\n        timestamp: new Date().toISOString(),\n      })),\n    }\n    addSOP(newSOP)\n    router.push(\"/dashboard\")\n  }\n\n  const handleReview = () => {\n    const sopId = `sop-${Date.now()}`\n    const newSOP: SOP = {\n      id: sopId,\n      title: \"New SOP\",\n      department: \"General\",\n      status: \"draft\",\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      content: \"\",\n      notes,\n      chatHistory: messages.map((m) => ({\n        id: m.id,\n        role: m.role === \"assistant\" ? \"ai\" : \"user\",\n        content: getDisplayMessage(m.content),\n        timestamp: new Date().toISOString(),\n      })),\n    }\n    addSOP(newSOP)\n    router.push(`/review/${sopId}`)\n  }\n\n  const handleDeleteNote = (id: string) => {\n    setNotes((prev) => prev.filter((n) => n.id !== id))\n  }\n\n  const handleSend = (content: string) => {\n    // Create a synthetic event to trigger handleSubmit\n    const fakeEvent = {\n      preventDefault: () => { },\n    } as React.FormEvent<HTMLFormElement>\n\n    // Set the input value and submit\n    handleInputChange({ target: { value: content } } as React.ChangeEvent<HTMLInputElement>)\n  }\n\n  const pendingMessageRef = useRef<string | null>(null)\n\n  const sendMessage = (content: string) => {\n    pendingMessageRef.current = content\n    handleInputChange({ target: { value: content } } as React.ChangeEvent<HTMLInputElement>)\n  }\n\n  useEffect(() => {\n    if (pendingMessageRef.current && input === pendingMessageRef.current) {\n      const fakeEvent = { preventDefault: () => { } } as React.FormEvent<HTMLFormElement>\n      handleSubmit(fakeEvent)\n      pendingMessageRef.current = null\n    }\n  }, [input, handleSubmit])\n\n  return (\n    <div className=\"min-h-screen bg-muted/30 flex flex-col\">\n      {/* Header */}\n      <header className=\"bg-background border-b border-border px-4 py-3 flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Link\n            href=\"/dashboard\"\n            className=\"text-muted-foreground hover:text-foreground flex items-center gap-2 transition-colors\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n            <span className=\"hidden sm:inline\">Back to Dashboard</span>\n          </Link>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <h1 className=\"text-lg font-semibold text-foreground\">Creating New SOP</h1>\n          <span className=\"hidden sm:inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary capitalize\">\n            {currentPhase.replace(\"_\", \" \")}\n          </span>\n        </div>\n        <Button variant=\"outline\" onClick={handleSaveDraft} className=\"gap-2 bg-transparent\">\n          <Save className=\"w-4 h-4\" />\n          <span className=\"hidden sm:inline\">Save Draft</span>\n        </Button>\n      </header>\n\n      {/* Mobile Tab Navigation */}\n      <div className=\"lg:hidden flex border-b border-border bg-background\">\n        <button\n          onClick={() => setActiveTab(\"chat\")}\n          className={cn(\n            \"flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors\",\n            activeTab === \"chat\"\n              ? \"text-primary border-b-2 border-primary\"\n              : \"text-muted-foreground hover:text-foreground\",\n          )}\n        >\n          <MessageSquare className=\"w-4 h-4\" />\n          Chat\n        </button>\n        <button\n          onClick={() => setActiveTab(\"notes\")}\n          className={cn(\n            \"flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors\",\n            activeTab === \"notes\"\n              ? \"text-primary border-b-2 border-primary\"\n              : \"text-muted-foreground hover:text-foreground\",\n          )}\n        >\n          <FileEdit className=\"w-4 h-4\" />\n          Notes ({notes.length})\n        </button>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 flex overflow-hidden\">\n        {/* Chat Area */}\n        <div\n          className={cn(\n            \"flex-1 flex flex-col bg-background\",\n            activeTab === \"notes\" ? \"hidden lg:flex\" : \"flex\",\n            \"lg:border-r border-border\",\n          )}\n        >\n          {/* Messages */}\n          <div className=\"flex-1 overflow-y-auto p-4 lg:p-6\">\n            {messages.map((message) => (\n              <MessageBubble\n                key={message.id}\n                message={{\n                  id: message.id,\n                  role: message.role === \"assistant\" ? \"ai\" : \"user\",\n                  content: getDisplayMessage(message.content),\n                  timestamp: new Date().toISOString(),\n                }}\n              />\n            ))}\n            {isLoading && <TypingIndicator />}\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Input */}\n          <ChatInput onSend={sendMessage} disabled={isLoading} />\n        </div>\n\n        {/* Notes Panel - Desktop */}\n        <div className={cn(\"w-96 hidden lg:flex flex-col\")}>\n          <NotesPanel\n            notes={notes}\n            onDeleteNote={handleDeleteNote}\n            onReview={handleReview}\n            progress={progress}\n            phase={currentPhase}\n          />\n        </div>\n\n        {/* Notes Panel - Mobile */}\n        <div className={cn(\"flex-1 lg:hidden\", activeTab === \"chat\" ? \"hidden\" : \"flex flex-col\")}>\n          <NotesPanel\n            notes={notes}\n            onDeleteNote={handleDeleteNote}\n            onReview={handleReview}\n            progress={progress}\n            phase={currentPhase}\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}