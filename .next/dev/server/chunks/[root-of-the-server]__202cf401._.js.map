{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/app/api/chat/generate-sop/route.ts"],"sourcesContent":["// =============================================================================\n// STEPWISE - GENERATE SOP API ROUTE\n// Transforms collected notes into a complete SOP document\n// Supports both CREATE (new SOP) and IMPROVE (existing SOP) modes\n// =============================================================================\n\nimport { streamText } from \"ai\"\nimport { google } from \"@ai-sdk/google\"\nimport type { Note, ChatMessage } from \"@/lib/types\"\nimport type { AnalysisResult } from \"@/lib/sop-analyzer\"\n\n// Allow longer execution for document generation\nexport const maxDuration = 60\n\n// -----------------------------------------------------------------------------\n// SOP Generation System Prompt (for CREATE mode)\n// -----------------------------------------------------------------------------\n\nconst CREATE_SOP_SYSTEM_PROMPT = `You are an expert technical writer specializing in creating comprehensive Standard Operating Procedures (SOPs). Your task is to generate a complete, professional SOP document from the provided conversation notes.\n\n## Output Format\nGenerate the SOP in clean Markdown format with the following structure:\n\n# [SOP Title]\n\n**Document ID:** SOP-[CATEGORY]-[NUMBER]\n**Version:** 1.0\n**Effective Date:** [Current Date]\n**Last Reviewed:** [Current Date]\n**Document Owner:** [From notes or \"To be assigned\"]\n**Approved By:** [From notes or \"Pending approval\"]\n\n---\n\n## 1. Purpose\n[Clear statement of why this procedure exists and what it accomplishes]\n\n## 2. Scope\n[Define what/who this SOP applies to and any exclusions]\n\n## 3. Responsibilities\n[List each role and their specific responsibilities in a table format]\n\n| Role | Responsibilities |\n|------|-----------------|\n| [Role 1] | [Responsibilities] |\n\n## 4. Definitions\n[Define key terms, acronyms, or technical language used]\n\n## 5. Procedure\n\n### 5.1 [First Major Step]\n**Prerequisites:** [If any]\n1. [Detailed sub-step]\n2. [Detailed sub-step]\n\n**Note:** [Important considerations]\n\n### 5.2 [Second Major Step]\n[Continue pattern...]\n\n## 6. Quality Metrics & Success Criteria\n[Measurable outcomes and KPIs]\n\n## 7. Troubleshooting\n[Common issues and resolutions in a table]\n\n| Issue | Possible Cause | Resolution |\n|-------|---------------|------------|\n| [Issue 1] | [Cause] | [Fix] |\n\n## 8. Related Documents\n[Links to related SOPs, forms, templates]\n\n## 9. Revision History\n\n| Version | Date | Author | Changes |\n|---------|------|--------|---------|\n| 1.0 | [Date] | [Author] | Initial release |\n\n---\n\n## Writing Guidelines:\n1. Use clear, action-oriented language (imperative mood)\n2. One action per step\n3. Include warnings/cautions where safety is concerned\n4. Be specific with quantities, timeframes, and measurements\n5. Avoid jargon unless defined\n6. Include decision points with clear criteria\n7. Add visual aids placeholders where helpful: [DIAGRAM: description]\n\nGenerate a thorough, professional SOP that could be immediately used in a real organization.`\n\n// -----------------------------------------------------------------------------\n// SOP Improvement System Prompt (for IMPROVE mode)\n// -----------------------------------------------------------------------------\n\nconst IMPROVE_SOP_SYSTEM_PROMPT = `You are an expert SOP editor and technical writer. Your task is to IMPROVE an existing SOP by:\n1. PRESERVING all the good content from the original\n2. ADDING new sections to fill gaps identified in the analysis\n3. INCORPORATING information gathered from the improvement conversation\n4. MAINTAINING the original tone, style, and quality\n\n## CRITICAL RULES:\n- This is an IMPROVEMENT task, NOT a complete rewrite\n- Keep approximately 70-80% of the original content intact\n- Only enhance or add what's necessary based on the analysis and conversation\n- Respect the original author's voice and style\n- Preserve all strengths identified in the analysis\n\n## Output Format:\nGenerate the improved SOP in clean Markdown format. Include all standard SOP sections:\n- Header (title, version, date, author)\n- Purpose\n- Scope  \n- Roles & Responsibilities\n- Definitions (if needed)\n- References\n- Materials & Resources (if applicable)\n- Procedure\n- Quality Checks\n- Troubleshooting\n- Appendices (if applicable)\n- Revision History\n\nUse tables where appropriate for clarity.`\n\n// -----------------------------------------------------------------------------\n// Helper: Organize Notes by Category\n// -----------------------------------------------------------------------------\n\nfunction organizeNotes(notes: Note[]): Record<string, Note[]> {\n  const notesByCategory: Record<string, Note[]> = {}\n\n  for (const note of notes) {\n    const category = note.category || \"OTHER\"\n    if (!notesByCategory[category]) {\n      notesByCategory[category] = []\n    }\n    notesByCategory[category].push(note)\n  }\n\n  return notesByCategory\n}\n\n// -----------------------------------------------------------------------------\n// Helper: Format Notes for Prompt\n// -----------------------------------------------------------------------------\n\nfunction formatNotesForPrompt(notesByCategory: Record<string, Note[]>): string {\n  return Object.entries(notesByCategory)\n    .map(([category, categoryNotes]) => {\n      const formattedNotes = categoryNotes\n        .map((n, i) => {\n          let noteText = `  ${i + 1}. ${n.content}`\n          if (n.relatedTo) noteText += ` (Related: ${n.relatedTo})`\n          if (n.action) noteText += ` - Action: ${n.action}`\n          return noteText\n        })\n        .join(\"\\n\")\n\n      return `### ${category.replace(/_/g, \" \")}\\n${formattedNotes}`\n    })\n    .join(\"\\n\\n\")\n}\n\n// -----------------------------------------------------------------------------\n// Helper: Get Missing Sections from Structure\n// -----------------------------------------------------------------------------\n\nfunction getMissingSections(structure: AnalysisResult['structure']): string[] {\n  const sectionMap: Record<string, boolean> = {\n    'Header': structure.hasHeader,\n    'Purpose': structure.hasPurpose,\n    'Scope': structure.hasScope,\n    'Roles': structure.hasRoles,\n    'Definitions': structure.hasDefinitions,\n    'References': structure.hasReferences,\n    'Materials': structure.hasMaterials,\n    'Procedures': structure.hasProcedures,\n    'Quality': structure.hasQuality,\n    'Troubleshooting': structure.hasTroubleshooting,\n    'Appendices': structure.hasAppendices,\n    'Revision': structure.hasRevision,\n  }\n\n  return Object.entries(sectionMap)\n    .filter(([_, present]) => !present)\n    .map(([section]) => section)\n}\n\n// -----------------------------------------------------------------------------\n// Helper: Format Analysis for Prompt\n// -----------------------------------------------------------------------------\n\nfunction formatAnalysisForPrompt(analysis: AnalysisResult): string {\n  const structure = analysis.structure\n  const missingSections = getMissingSections(structure)\n\n  const presentSections: string[] = []\n  if (structure.hasHeader) presentSections.push('Header')\n  if (structure.hasPurpose) presentSections.push('Purpose')\n  if (structure.hasScope) presentSections.push('Scope')\n  if (structure.hasRoles) presentSections.push('Roles')\n  if (structure.hasDefinitions) presentSections.push('Definitions')\n  if (structure.hasReferences) presentSections.push('References')\n  if (structure.hasMaterials) presentSections.push('Materials')\n  if (structure.hasProcedures) presentSections.push('Procedures')\n  if (structure.hasQuality) presentSections.push('Quality')\n  if (structure.hasTroubleshooting) presentSections.push('Troubleshooting')\n  if (structure.hasAppendices) presentSections.push('Appendices')\n  if (structure.hasRevision) presentSections.push('Revision')\n\n  const strengthsList = analysis.strengths.map(s => `✓ ${s}`).join('\\n')\n  const issuesList = analysis.improvements.map(i =>\n    `• [${i.priority}] ${i.category}: ${i.description}`\n  ).join('\\n')\n\n  let result = `## Analysis Results\n**Quality Score:** ${analysis.quality.overall}/100\n**Completeness Score:** ${structure.completenessScore}%\n\n### Strengths (PRESERVE THESE):\n${strengthsList}\n\n### Issues That Were Addressed:\n${issuesList}\n\n### Structure Analysis:\n`\n\n  if (presentSections.length > 0) {\n    result += `**Present Sections:** ${presentSections.join(', ')}\\n`\n  }\n  if (missingSections.length > 0) {\n    result += `**Missing Sections (ADD THESE):** ${missingSections.join(', ')}\\n`\n  }\n\n  return result\n}\n\n// -----------------------------------------------------------------------------\n// Helper: Format Conversation for Prompt\n// -----------------------------------------------------------------------------\n\nfunction formatConversationForPrompt(messages: ChatMessage[]): string {\n  // Filter to only include user and assistant messages (not system)\n  const relevantMessages = messages.filter(m => m.role === 'user' || m.role === 'ai')\n\n  if (relevantMessages.length === 0) {\n    return \"No improvement conversation available.\"\n  }\n\n  return relevantMessages\n    .map(msg => `**${msg.role.toUpperCase()}:** ${msg.content}`)\n    .join('\\n\\n')\n}\n\n// -----------------------------------------------------------------------------\n// Build Improvement Prompt\n// -----------------------------------------------------------------------------\n\nfunction buildImprovementPrompt(\n  originalContent: string,\n  analysis: AnalysisResult | null,\n  conversationHistory: ChatMessage[],\n  notes: Note[],\n  title: string\n): string {\n  const notesByCategory = organizeNotes(notes)\n  const notesContext = formatNotesForPrompt(notesByCategory)\n\n  let prompt = `# TASK: Improve Existing SOP\n\n**SOP Title:** ${title}\n\n`\n\n  // Add original SOP content\n  prompt += `## ORIGINAL SOP CONTENT\n=== START OF ORIGINAL ===\n${originalContent}\n=== END OF ORIGINAL ===\n\n`\n\n  // Add analysis results if available\n  if (analysis) {\n    prompt += formatAnalysisForPrompt(analysis)\n    prompt += '\\n\\n'\n  }\n\n  // Add conversation history\n  prompt += `## IMPROVEMENT CONVERSATION\nThe following conversation was had to gather information for improvements:\n\n${formatConversationForPrompt(conversationHistory)}\n\n`\n\n  // Add extracted notes\n  prompt += `## EXTRACTED NOTES FROM CONVERSATION\nThese notes contain specific information to incorporate:\n\n${notesContext}\n\n`\n\n  // Build missing sections string\n  const missingSectionsStr = analysis\n    ? getMissingSections(analysis.structure).join(', ')\n    : ''\n\n  // Add specific instructions\n  prompt += `## YOUR TASK\nGenerate an IMPROVED version of the SOP that:\n\n1. **PRESERVES all existing good content** - The original SOP has strengths, keep them\n2. **ADDS missing sections** identified in the analysis${missingSectionsStr ? `: ${missingSectionsStr}` : ''}\n3. **INCORPORATES information from the notes** - Use the extracted notes to fill gaps\n4. **MAINTAINS the original tone and style** - Don't unnecessarily rewrite good content\n5. **Updates the version number** - Increment to show this is an improved version\n\nIMPORTANT: This is an improvement, not a rewrite. The goal is to enhance the existing SOP while preserving its strengths.\n\nGenerate the complete improved SOP now in Markdown format:`\n\n  return prompt\n}\n\n// -----------------------------------------------------------------------------\n// Build Create Prompt\n// -----------------------------------------------------------------------------\n\nfunction buildCreatePrompt(notes: Note[], title: string, description?: string): string {\n  const notesByCategory = organizeNotes(notes)\n  const notesContext = formatNotesForPrompt(notesByCategory)\n\n  return `Generate a complete SOP document based on these conversation notes:\n\n${title ? `**SOP Title:** ${title}` : \"\"}\n${description ? `**Description:** ${description}` : \"\"}\n\n## Collected Information:\n\n${notesContext}\n\nPlease generate a comprehensive, well-structured SOP document in Markdown format following the standard SOP template. Make sure to:\n1. Fill in all sections based on the notes provided\n2. Infer reasonable details where information might be missing\n3. Use professional language appropriate for an official document\n4. Include placeholder markers [TBD] for any critical information that couldn't be determined\n5. Add helpful notes and warnings where appropriate`\n}\n\n// -----------------------------------------------------------------------------\n// POST Handler\n// -----------------------------------------------------------------------------\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json()\n\n    // Extract all possible fields\n    const {\n      mode = 'create',\n      notes = [],\n      title = 'Standard Operating Procedure',\n      description,\n      originalContent,\n      analysis,\n      conversationHistory = []\n    } = body as {\n      mode?: 'create' | 'improve'\n      notes: Note[]\n      title?: string\n      description?: string\n      originalContent?: string\n      analysis?: AnalysisResult\n      conversationHistory?: ChatMessage[]\n    }\n\n    let systemPrompt: string\n    let userPrompt: string\n\n    if (mode === 'improve' && originalContent) {\n      // IMPROVEMENT MODE: Use full context\n      console.log('Generating improved SOP with full context...')\n      console.log(`- Original content length: ${originalContent.length} chars`)\n      console.log(`- Analysis available: ${!!analysis}`)\n      console.log(`- Conversation messages: ${conversationHistory.length}`)\n      console.log(`- Notes collected: ${notes.length}`)\n\n      systemPrompt = IMPROVE_SOP_SYSTEM_PROMPT\n      userPrompt = buildImprovementPrompt(\n        originalContent,\n        analysis || null,\n        conversationHistory,\n        notes,\n        title\n      )\n    } else {\n      // CREATE MODE: Generate from notes only\n      console.log('Generating new SOP from notes...')\n      console.log(`- Notes collected: ${notes.length}`)\n\n      systemPrompt = CREATE_SOP_SYSTEM_PROMPT\n      userPrompt = buildCreatePrompt(notes, title, description)\n    }\n\n    // Stream the response\n    const result = streamText({\n      model: google(\"gemini-3-flash-preview\"),\n      system: systemPrompt,\n      prompt: userPrompt,\n      temperature: 0.3, // Lower temperature for more consistent output\n    })\n\n    return result.toTextStreamResponse()\n  } catch (error) {\n    console.error(\"Generate SOP API Error:\", error)\n\n    return new Response(\n      JSON.stringify({\n        error: \"Failed to generate SOP\",\n        details: error instanceof Error ? error.message : \"Unknown error\"\n      }),\n      {\n        status: 500,\n        headers: { \"Content-Type\": \"application/json\" }\n      }\n    )\n  }\n}\n"],"names":[],"mappings":"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"}}]
}