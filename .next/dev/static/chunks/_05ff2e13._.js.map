{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/ui/scroll-area.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'\n\nimport { cn } from '@/lib/utils'\n\nfunction ScrollArea({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\n  return (\n    <ScrollAreaPrimitive.Root\n      data-slot=\"scroll-area\"\n      className={cn('relative', className)}\n      {...props}\n    >\n      <ScrollAreaPrimitive.Viewport\n        data-slot=\"scroll-area-viewport\"\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\n      >\n        {children}\n      </ScrollAreaPrimitive.Viewport>\n      <ScrollBar />\n      <ScrollAreaPrimitive.Corner />\n    </ScrollAreaPrimitive.Root>\n  )\n}\n\nfunction ScrollBar({\n  className,\n  orientation = 'vertical',\n  ...props\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\n  return (\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\n      data-slot=\"scroll-area-scrollbar\"\n      orientation={orientation}\n      className={cn(\n        'flex touch-none p-px transition-colors select-none',\n        orientation === 'vertical' &&\n          'h-full w-2.5 border-l border-l-transparent',\n        orientation === 'horizontal' &&\n          'h-2.5 flex-col border-t border-t-transparent',\n        className,\n      )}\n      {...props}\n    >\n      <ScrollAreaPrimitive.ScrollAreaThumb\n        data-slot=\"scroll-area-thumb\"\n        className=\"bg-border relative flex-1 rounded-full\"\n      />\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\n  )\n}\n\nexport { ScrollArea, ScrollBar }\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,6LAAC,qLAAwB;QACvB,aAAU;QACV,WAAW,IAAA,qHAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,6LAAC,yLAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,6LAAC;;;;;0BACD,6LAAC,uLAA0B;;;;;;;;;;;AAGjC;KArBS;AAuBT,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,6LAAC,oMAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,qHAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,gMAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB;MAzBS"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/chat/phase-indicator.tsx"],"sourcesContent":["\"use client\"\n\n// =============================================================================\n// STEPWISE - PHASE INDICATOR\n// Visual progress indicator for the 5-phase conversation flow\n// =============================================================================\n\nimport { CheckCircle2, Circle, Loader2 } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { CONVERSATION_PHASES, type ConversationPhase } from \"@/lib/types\"\n\n// -----------------------------------------------------------------------------\n// Types\n// -----------------------------------------------------------------------------\n\ninterface PhaseIndicatorProps {\n    currentPhase: ConversationPhase\n    progress: number // 0-100 overall progress\n    className?: string\n    variant?: \"compact\" | \"detailed\"\n}\n\n// -----------------------------------------------------------------------------\n// Phase Configuration\n// -----------------------------------------------------------------------------\n\nconst PHASE_ORDER: ConversationPhase[] = [\n    \"foundation\",\n    \"process\",\n    \"accountability\",\n    \"quality\",\n    \"finalization\",\n]\n\n// -----------------------------------------------------------------------------\n// Component\n// -----------------------------------------------------------------------------\n\nexport function PhaseIndicator({\n    currentPhase,\n    progress,\n    className,\n    variant = \"compact\",\n}: PhaseIndicatorProps) {\n    const currentIndex = PHASE_ORDER.indexOf(currentPhase)\n\n    if (variant === \"compact\") {\n        return (\n            <div className={cn(\"flex items-center gap-2\", className)}>\n                {/* Phase Pills */}\n                <div className=\"flex items-center gap-1\">\n                    {PHASE_ORDER.map((phase, index) => {\n                        const isComplete = index < currentIndex\n                        const isCurrent = index === currentIndex\n                        const isPending = index > currentIndex\n\n                        return (\n                            <div\n                                key={phase}\n                                className={cn(\n                                    \"h-2 rounded-full transition-all duration-300\",\n                                    index === 0 ? \"w-8\" : \"w-6\",\n                                    isComplete && \"bg-emerald-500\",\n                                    isCurrent && \"bg-blue-600\",\n                                    isPending && \"bg-slate-200\"\n                                )}\n                                title={CONVERSATION_PHASES[phase].name}\n                            />\n                        )\n                    })}\n                </div>\n\n                {/* Current Phase Label */}\n                <span className=\"text-xs font-medium text-slate-600\">\n                    {CONVERSATION_PHASES[currentPhase].name}\n                </span>\n\n                {/* Progress Percentage */}\n                <span className=\"text-xs text-slate-400\">\n                    {Math.round(progress)}%\n                </span>\n            </div>\n        )\n    }\n\n    // Detailed variant\n    return (\n        <div className={cn(\"space-y-4\", className)}>\n            {/* Overall Progress Bar */}\n            <div className=\"space-y-1\">\n                <div className=\"flex items-center justify-between text-sm\">\n                    <span className=\"font-medium text-slate-900\">\n                        {CONVERSATION_PHASES[currentPhase].name}\n                    </span>\n                    <span className=\"text-slate-500\">{Math.round(progress)}% complete</span>\n                </div>\n                <div className=\"h-2 bg-slate-100 rounded-full overflow-hidden\">\n                    <div\n                        className=\"h-full bg-blue-600 rounded-full transition-all duration-500 ease-out\"\n                        style={{ width: `${progress}%` }}\n                    />\n                </div>\n            </div>\n\n            {/* Phase Steps */}\n            <div className=\"space-y-2\">\n                {PHASE_ORDER.map((phase, index) => {\n                    const phaseInfo = CONVERSATION_PHASES[phase]\n                    const isComplete = index < currentIndex\n                    const isCurrent = index === currentIndex\n                    const isPending = index > currentIndex\n\n                    return (\n                        <div\n                            key={phase}\n                            className={cn(\n                                \"flex items-center gap-3 p-2 rounded-lg transition-colors\",\n                                isCurrent && \"bg-blue-50\",\n                                isComplete && \"bg-emerald-50/50\"\n                            )}\n                        >\n                            {/* Icon */}\n                            <div\n                                className={cn(\n                                    \"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0\",\n                                    isComplete && \"bg-emerald-500 text-white\",\n                                    isCurrent && \"bg-blue-600 text-white\",\n                                    isPending && \"bg-slate-200 text-slate-400\"\n                                )}\n                            >\n                                {isComplete ? (\n                                    <CheckCircle2 className=\"w-4 h-4\" />\n                                ) : isCurrent ? (\n                                    <Loader2 className=\"w-4 h-4 animate-spin\" />\n                                ) : (\n                                    <Circle className=\"w-3 h-3\" />\n                                )}\n                            </div>\n\n                            {/* Text */}\n                            <div className=\"flex-1 min-w-0\">\n                                <div\n                                    className={cn(\n                                        \"text-sm font-medium truncate\",\n                                        isComplete && \"text-emerald-700\",\n                                        isCurrent && \"text-blue-700\",\n                                        isPending && \"text-slate-400\"\n                                    )}\n                                >\n                                    {phaseInfo.name}\n                                </div>\n                                <div\n                                    className={cn(\n                                        \"text-xs truncate\",\n                                        isComplete && \"text-emerald-600/70\",\n                                        isCurrent && \"text-blue-600/70\",\n                                        isPending && \"text-slate-400\"\n                                    )}\n                                >\n                                    {phaseInfo.description}\n                                </div>\n                            </div>\n\n                            {/* Status */}\n                            {isComplete && (\n                                <span className=\"text-xs font-medium text-emerald-600\">Done</span>\n                            )}\n                            {isCurrent && (\n                                <span className=\"text-xs font-medium text-blue-600\">In Progress</span>\n                            )}\n                        </div>\n                    )\n                })}\n            </div>\n        </div>\n    )\n}\n\n// -----------------------------------------------------------------------------\n// Mini Phase Badge (for header)\n// -----------------------------------------------------------------------------\n\ninterface PhaseBadgeProps {\n    phase: ConversationPhase\n    progress: number\n    className?: string\n}\n\nexport function PhaseBadge({ phase, progress, className }: PhaseBadgeProps) {\n    return (\n        <div\n            className={cn(\n                \"inline-flex items-center gap-2 px-3 py-1.5 rounded-full\",\n                \"bg-blue-50 border border-blue-200\",\n                className\n            )}\n        >\n            <div className=\"w-2 h-2 rounded-full bg-blue-600 animate-pulse\" />\n            <span className=\"text-xs font-medium text-blue-700\">\n                {CONVERSATION_PHASES[phase].name}\n            </span>\n            <span className=\"text-xs text-blue-500\">{Math.round(progress)}%</span>\n        </div>\n    )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 451, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/components/notes/notes-panel.tsx"],"sourcesContent":["\"use client\"\n\n// =============================================================================\n// STEPWISE - ENHANCED NOTES PANEL\n// Displays categorized notes with priority indicators\n// =============================================================================\n\nimport { useState, useMemo } from \"react\"\nimport { FileEdit, Trash2, ChevronDown, ChevronRight, Sparkles } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\nimport { cn } from \"@/lib/utils\"\nimport {\n  type Note,\n  type NoteCategory,\n  CATEGORY_STYLES,\n  PRIORITY_STYLES,\n  NOTE_CATEGORIES,\n} from \"@/lib/types\"\nimport { PhaseIndicator } from \"@/components/chat/phase-indicator\"\nimport type { ConversationPhase } from \"@/lib/types\"\n\n// -----------------------------------------------------------------------------\n// Types\n// -----------------------------------------------------------------------------\n\ninterface NotesPanelProps {\n  notes: Note[]\n  onDeleteNote?: (id: string) => void\n  onEditNote?: (note: Note) => void\n  onReview?: () => void\n  progress: number\n  phase: ConversationPhase | string\n}\n\n// -----------------------------------------------------------------------------\n// Note Card Component\n// -----------------------------------------------------------------------------\n\nfunction NoteCard({\n  note,\n  onDelete,\n  onEdit,\n}: {\n  note: Note\n  onDelete?: () => void\n  onEdit?: () => void\n}) {\n  const categoryStyle = CATEGORY_STYLES[note.category] || CATEGORY_STYLES.METADATA\n  const priorityStyle = PRIORITY_STYLES[note.priority]\n\n  return (\n    <div className=\"bg-white rounded-lg border border-slate-200 p-3 hover:shadow-sm transition-shadow\">\n      {/* Header */}\n      <div className=\"flex items-start justify-between gap-2 mb-2\">\n        <div className=\"flex items-center gap-2 flex-wrap\">\n          <span\n            className={cn(\n              \"px-2 py-0.5 rounded text-xs font-medium\",\n              categoryStyle.bg,\n              categoryStyle.text\n            )}\n          >\n            {categoryStyle.label}\n          </span>\n          <span className={cn(\"text-sm font-bold\", priorityStyle.color)}>\n            {priorityStyle.icon}\n          </span>\n        </div>\n        <span className=\"text-xs text-slate-400 whitespace-nowrap\">\n          {note.timestamp}\n        </span>\n      </div>\n\n      {/* Content */}\n      <p className=\"text-sm text-slate-700 mb-2 line-clamp-3\">{note.content}</p>\n\n      {/* Related To */}\n      {note.relatedTo && (\n        <p className=\"text-xs text-slate-500 mb-2\">\n          <span className=\"font-medium\">â†’</span> {note.relatedTo}\n        </p>\n      )}\n\n      {/* Actions */}\n      <div className=\"flex items-center justify-between pt-2 border-t border-slate-100\">\n        <span className=\"text-xs text-slate-400\">{note.source}</span>\n        <div className=\"flex items-center gap-1\">\n          {onEdit && (\n            <button\n              onClick={onEdit}\n              className=\"p-1 text-slate-400 hover:text-slate-600 transition-colors\"\n              title=\"Edit note\"\n            >\n              <FileEdit className=\"w-3.5 h-3.5\" />\n            </button>\n          )}\n          {onDelete && (\n            <button\n              onClick={onDelete}\n              className=\"p-1 text-slate-400 hover:text-red-500 transition-colors\"\n              title=\"Delete note\"\n            >\n              <Trash2 className=\"w-3.5 h-3.5\" />\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Category Group Component\n// -----------------------------------------------------------------------------\n\nfunction CategoryGroup({\n  category,\n  notes,\n  onDeleteNote,\n  onEditNote,\n  defaultExpanded = true,\n}: {\n  category: NoteCategory\n  notes: Note[]\n  onDeleteNote?: (id: string) => void\n  onEditNote?: (note: Note) => void\n  defaultExpanded?: boolean\n}) {\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded)\n  const categoryStyle = CATEGORY_STYLES[category]\n\n  return (\n    <div className=\"space-y-2\">\n      {/* Category Header */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        className=\"w-full flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 transition-colors\"\n      >\n        <div className=\"flex items-center gap-2\">\n          {isExpanded ? (\n            <ChevronDown className=\"w-4 h-4 text-slate-400\" />\n          ) : (\n            <ChevronRight className=\"w-4 h-4 text-slate-400\" />\n          )}\n          <span\n            className={cn(\n              \"px-2 py-0.5 rounded text-xs font-medium\",\n              categoryStyle.bg,\n              categoryStyle.text\n            )}\n          >\n            {categoryStyle.label}\n          </span>\n        </div>\n        <span className=\"text-xs text-slate-400\">{notes.length}</span>\n      </button>\n\n      {/* Notes */}\n      {isExpanded && (\n        <div className=\"space-y-2 pl-6\">\n          {notes.map((note) => (\n            <NoteCard\n              key={note.id}\n              note={note}\n              onDelete={onDeleteNote ? () => onDeleteNote(note.id) : undefined}\n              onEdit={onEditNote ? () => onEditNote(note) : undefined}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Main Notes Panel\n// -----------------------------------------------------------------------------\n\nexport function NotesPanel({\n  notes,\n  onDeleteNote,\n  onEditNote,\n  onReview,\n  progress,\n  phase,\n}: NotesPanelProps) {\n  const [viewMode, setViewMode] = useState<\"grouped\" | \"list\">(\"grouped\")\n\n  // Group notes by category\n  const groupedNotes = useMemo(() => {\n    const groups: Partial<Record<NoteCategory, Note[]>> = {}\n\n    for (const note of notes) {\n      if (!groups[note.category]) {\n        groups[note.category] = []\n      }\n      groups[note.category]!.push(note)\n    }\n\n    return groups\n  }, [notes])\n\n  // Order categories by priority (procedure steps first, etc.)\n  const categoryOrder: NoteCategory[] = [\n    \"HEADER_INFO\",\n    \"PURPOSE_SCOPE\",\n    \"ROLES_RESPONSIBILITIES\",\n    \"PROCEDURE_STEPS\",\n    \"DECISION_POINTS\",\n    \"QUALITY_SUCCESS\",\n    \"TROUBLESHOOTING\",\n    \"MATERIALS_RESOURCES\",\n    \"DEFINITIONS_REFERENCES\",\n    \"VISUAL_AIDS\",\n    \"GAPS_IMPROVEMENTS\",\n    \"METADATA\",\n  ]\n\n  const sortedCategories = categoryOrder.filter(\n    (cat) => groupedNotes[cat] && groupedNotes[cat]!.length > 0\n  )\n\n  // Convert phase string to ConversationPhase type\n  const normalizedPhase = (phase as ConversationPhase) || \"foundation\"\n\n  return (\n    <div className=\"h-full flex flex-col bg-slate-50\">\n      {/* Header */}\n      <div className=\"p-4 border-b border-slate-200 bg-white\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <h3 className=\"font-semibold text-slate-900\">Extracted Notes</h3>\n          <span className=\"text-sm text-slate-500\">{notes.length} notes</span>\n        </div>\n\n        {/* Phase Progress */}\n        <PhaseIndicator\n          currentPhase={normalizedPhase}\n          progress={progress}\n          variant=\"compact\"\n        />\n      </div>\n\n      {/* Notes Content */}\n      <ScrollArea className=\"flex-1 p-4\">\n        {notes.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <div className=\"w-12 h-12 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-3\">\n              <FileEdit className=\"w-6 h-6 text-slate-400\" />\n            </div>\n            <p className=\"text-sm text-slate-500 mb-1\">No notes yet</p>\n            <p className=\"text-xs text-slate-400\">\n              Notes will appear here as you chat with the AI\n            </p>\n          </div>\n        ) : viewMode === \"grouped\" ? (\n          <div className=\"space-y-4\">\n            {sortedCategories.map((category) => (\n              <CategoryGroup\n                key={category}\n                category={category}\n                notes={groupedNotes[category]!}\n                onDeleteNote={onDeleteNote}\n                onEditNote={onEditNote}\n                defaultExpanded={true}\n              />\n            ))}\n          </div>\n        ) : (\n          <div className=\"space-y-2\">\n            {notes.map((note) => (\n              <NoteCard\n                key={note.id}\n                note={note}\n                onDelete={onDeleteNote ? () => onDeleteNote(note.id) : undefined}\n                onEdit={onEditNote ? () => onEditNote(note) : undefined}\n              />\n            ))}\n          </div>\n        )}\n      </ScrollArea>\n\n      {/* Footer Actions */}\n      <div className=\"p-4 border-t border-slate-200 bg-white\">\n        <div className=\"flex items-center gap-2 mb-3\">\n          <button\n            onClick={() => setViewMode(\"grouped\")}\n            className={cn(\n              \"flex-1 py-1.5 text-xs font-medium rounded transition-colors\",\n              viewMode === \"grouped\"\n                ? \"bg-blue-100 text-blue-700\"\n                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\n            )}\n          >\n            By Category\n          </button>\n          <button\n            onClick={() => setViewMode(\"list\")}\n            className={cn(\n              \"flex-1 py-1.5 text-xs font-medium rounded transition-colors\",\n              viewMode === \"list\"\n                ? \"bg-blue-100 text-blue-700\"\n                : \"bg-slate-100 text-slate-600 hover:bg-slate-200\"\n            )}\n          >\n            All Notes\n          </button>\n        </div>\n\n        <Button\n          onClick={onReview}\n          disabled={notes.length === 0}\n          className=\"w-full bg-blue-600 hover:bg-blue-700 text-white gap-2\"\n        >\n          <Sparkles className=\"w-4 h-4\" />\n          Review & Generate SOP\n        </Button>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 946, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/lib/ai-response-parser.ts"],"sourcesContent":["// =============================================================================\n// STEPWISE - AI RESPONSE PARSER\n// Handles parsing and validation of AI responses\n// =============================================================================\n\nimport {\n    type AIResponse,\n    type AIResponseNote,\n    type Note,\n    type ConversationPhase,\n    isValidNoteCategory,\n    isValidPhase,\n    generateId,\n    NOTE_CATEGORIES,\n    aiResponseSchema,\n} from './types'\n\n// -----------------------------------------------------------------------------\n// Constants & Mappings\n// -----------------------------------------------------------------------------\n\nconst CATEGORY_ALIASES: Record<string, string> = {\n    'HEADER': 'HEADER_INFO',\n    'PURPOSE': 'PURPOSE_SCOPE',\n    'SCOPE': 'PURPOSE_SCOPE',\n    'ROLES': 'ROLES_RESPONSIBILITIES',\n    'RESPONSIBILITIES': 'ROLES_RESPONSIBILITIES',\n    'PROCEDURE': 'PROCEDURE_STEPS',\n    'STEPS': 'PROCEDURE_STEPS',\n    'DECISION': 'DECISION_POINTS',\n    'QUALITY': 'QUALITY_SUCCESS',\n    'SUCCESS': 'QUALITY_SUCCESS',\n    'TROUBLESHOOT': 'TROUBLESHOOTING',\n    'ERRORS': 'TROUBLESHOOTING',\n    'DEFINITIONS': 'DEFINITIONS_REFERENCES',\n    'REFERENCES': 'DEFINITIONS_REFERENCES',\n    'GLOSSARY': 'DEFINITIONS_REFERENCES',\n    'MATERIALS': 'MATERIALS_RESOURCES',\n    'RESOURCES': 'MATERIALS_RESOURCES',\n    'EQUIPMENT': 'MATERIALS_RESOURCES',\n    'VISUAL': 'VISUAL_AIDS',\n    'FLOWCHART': 'VISUAL_AIDS',\n    'GAPS': 'GAPS_IMPROVEMENTS',\n    'IMPROVEMENTS': 'GAPS_IMPROVEMENTS',\n    'META': 'METADATA',\n}\n\n// -----------------------------------------------------------------------------\n// Response Parsing\n// -----------------------------------------------------------------------------\n\n/**\n * Attempts to extract JSON from a string that may contain markdown code blocks\n */\nfunction extractJSON(content: string): string {\n    // Check for markdown code blocks\n    const jsonBlockMatch = content.match(/```(?:json)?\\s*([\\s\\S]*?)```/)\n    if (jsonBlockMatch) {\n        return jsonBlockMatch[1].trim()\n    }\n\n    // Check for raw JSON (starts with {)\n    const jsonMatch = content.match(/\\{[\\s\\S]*\\}/)\n    if (jsonMatch) {\n        return jsonMatch[0]\n    }\n\n    return content\n}\n\n/**\n * Validates and normalizes note category using mapping and Zod\n */\nfunction normalizeCategory(category: string): string {\n    const normalized = category.toUpperCase().replace(/\\s+/g, '_')\n    return CATEGORY_ALIASES[normalized] || normalized\n}\n\n/**\n * Converts an AI response note to a full Note object\n */\nfunction convertToNote(aiNote: AIResponseNote, messageNumber: number): Note {\n    const normalizedCategory = normalizeCategory(aiNote.category)\n\n    return {\n        id: generateId('note'),\n        category: isValidNoteCategory(normalizedCategory) ? normalizedCategory : 'METADATA',\n        priority: aiNote.priority || 'medium',\n        timestamp: `Message ${messageNumber}`,\n        source: 'AI Extraction',\n        content: aiNote.content || '',\n        relatedTo: aiNote.relatedTo || '',\n        action: aiNote.action || '',\n    }\n}\n\n/**\n * Parses AI response into structured format\n * Handles JSON, partial JSON, and plain text responses\n */\nexport function parseAIResponse(\n    content: string,\n    messageNumber: number = 0\n): {\n    message: string\n    notes: Note[]\n    phase: ConversationPhase\n    progress: number\n    parseSuccess: boolean\n} {\n    const defaultResult = {\n        message: content,\n        notes: [],\n        phase: 'foundation' as ConversationPhase,\n        progress: 0,\n        parseSuccess: false,\n    }\n\n    try {\n        const jsonStr = extractJSON(content)\n        const rawParsed = JSON.parse(jsonStr)\n        \n        // Use Zod for strict validation\n        const result = aiResponseSchema.safeParse(rawParsed)\n\n        if (!result.success) {\n            // Fallback for partial objects if message exists\n            if (rawParsed && typeof rawParsed.message === 'string') {\n                return {\n                    ...defaultResult,\n                    message: rawParsed.message,\n                    phase: isValidPhase(rawParsed.phase) ? rawParsed.phase : 'foundation',\n                    progress: typeof rawParsed.progress === 'number' ? rawParsed.progress : 0,\n                }\n            }\n            return defaultResult\n        }\n\n        const parsed = result.data\n\n        return {\n            message: parsed.message,\n            notes: parsed.notes.map(n => convertToNote(n, messageNumber)),\n            phase: parsed.phase,\n            progress: parsed.progress,\n            parseSuccess: true,\n        }\n    } catch {\n        return defaultResult\n    }\n}\n\n/**\n * Validates that an AI response has minimum required information\n */\nexport function validateAIResponse(response: AIResponse): {\n    isValid: boolean\n    errors: string[]\n} {\n    const errors: string[] = []\n\n    if (!response.message || response.message.trim().length === 0) {\n        errors.push('Response message is empty')\n    }\n\n    if (response.phase && !isValidPhase(response.phase)) {\n        errors.push(`Invalid phase: ${response.phase}`)\n    }\n\n    if (response.progress < 0 || response.progress > 100) {\n        errors.push(`Progress must be between 0 and 100, got: ${response.progress}`)\n    }\n\n    // Validate notes\n    for (const note of response.notes || []) {\n        const normalizedCategory = normalizeCategory(note.category)\n        if (!isValidNoteCategory(normalizedCategory)) {\n            errors.push(`Invalid note category: ${note.category}`)\n        }\n    }\n\n    return {\n        isValid: errors.length === 0,\n        errors,\n    }\n}\n\n/**\n * Gets the display message from a potentially JSON-encoded response\n */\nexport function getDisplayMessage(content: string): string {\n    try {\n        const jsonStr = extractJSON(content)\n        const parsed = JSON.parse(jsonStr)\n        return parsed.message || content\n    } catch {\n        return content\n    }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1103, "column": 0}, "map": {"version":3,"sources":["file:///home/hembi/Desktop/sop-builder-mvp/app/create/page.tsx"],"sourcesContent":["\"use client\"\n\n// =============================================================================\n// STEPWISE - CREATE SOP PAGE\n// Main interface for AI-powered SOP creation with 5-phase conversation flow\n// =============================================================================\n\nimport { useState, useRef, useEffect, useCallback } from \"react\"\nimport Link from \"next/link\"\nimport { useRouter } from \"next/navigation\"\nimport { useChat } from \"@ai-sdk/react\"\nimport { DefaultChatTransport } from \"ai\"\nimport { ArrowLeft, Save, FileEdit, MessageSquare, Loader2, Bot, User, Send } from \"lucide-react\"\nimport { Button } from \"@/components/ui/button\"\nimport { NotesPanel } from \"@/components/notes/notes-panel\"\nimport { PhaseBadge } from \"@/components/chat/phase-indicator\"\nimport { useSOPContext } from \"@/lib/sop-context\"\nimport { parseAIResponse } from \"@/lib/ai-response-parser\"\nimport { cn } from \"@/lib/utils\"\nimport type { Note, ConversationPhase, SOP, ChatMessage } from \"@/lib/types\"\n\n// -----------------------------------------------------------------------------\n// Helper: Extract text from message parts\n// -----------------------------------------------------------------------------\n\nfunction getMessageText(parts: unknown): string {\n  if (!Array.isArray(parts)) return \"\"\n  return parts\n    .filter((part): part is { type: string; text: string } =>\n      part && typeof part === \"object\" && part.type === \"text\" && typeof part.text === \"string\"\n    )\n    .map((part) => part.text)\n    .join(\"\")\n}\n\nfunction extractMessageFromPartialJson(text: string): string {\n  // 1. Try standard parse first (for complete messages)\n  try {\n    const parsed = JSON.parse(text)\n    return parsed.message || text\n  } catch {\n    // 2. Fallback: regex extraction for the specific \"message\" field\n    // Matches \"message\": \"CONTENT...\" allowing for escaped quotes\n    const match = text.match(/\"message\"\\s*:\\s*\"((?:[^\"\\\\]|\\\\.)*?)(?:\"|$)/)\n    if (match) {\n      // Unescape characters (like \\n or \\\") to make it readable\n      try {\n        return JSON.parse(`\"${match[1]}\"`)\n      } catch {\n        return match[1]\n      }\n    }\n    \n    // 3. If it looks like the start of a JSON object but we haven't found the message yet,\n    // return an empty string (or \"Thinking...\") to avoid showing raw brackets.\n    if (text.trim().startsWith(\"{\")) {\n      return \"\" \n    }\n    \n    return text\n  }\n}\n\n// -----------------------------------------------------------------------------\n// Initial Greeting Message\n// -----------------------------------------------------------------------------\n\nconst INITIAL_GREETING =\n  \"Hello! I'm here to help you create a professional SOP. Let's start with the basics.\\n\\nWhat process or procedure would you like to document today?\"\n\n// -----------------------------------------------------------------------------\n// Message Bubble Component\n// -----------------------------------------------------------------------------\n\ninterface MessageBubbleProps {\n  role: \"user\" | \"assistant\"\n  content: string\n  isStreaming?: boolean\n}\n\nfunction MessageBubble({ role, content, isStreaming }: MessageBubbleProps) {\n  const isAI = role === \"assistant\"\n\n  // Parse AI responses to extract just the message part (if JSON)\n  let displayContent = content\n  if (isAI && content) {\n    displayContent = extractMessageFromPartialJson(content)\n  }\n\n  return (\n    <div className={cn(\"flex gap-3 mb-4\", isAI ? \"justify-start\" : \"justify-end\")}>\n      {isAI && (\n        <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0\">\n          <Bot className=\"w-4 h-4 text-white\" />\n        </div>\n      )}\n      <div\n        className={cn(\n          \"max-w-[85%] sm:max-w-[80%] px-3 sm:px-4 py-2.5 sm:py-3 rounded-2xl\",\n          isAI ? \"bg-gray-100 text-gray-900 rounded-tl-sm\" : \"bg-blue-600 text-white rounded-tr-sm\"\n        )}\n      >\n        <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{displayContent}</p>\n        {isStreaming && <span className=\"inline-block w-2 h-4 bg-blue-600 animate-pulse ml-0.5\" />}\n      </div>\n      {!isAI && (\n        <div className=\"w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0\">\n          <User className=\"w-4 h-4 text-gray-600\" />\n        </div>\n      )}\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Typing Indicator Component\n// -----------------------------------------------------------------------------\n\nfunction TypingIndicator() {\n  return (\n    <div className=\"flex gap-3 mb-4 justify-start\">\n      <div className=\"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0\">\n        <Bot className=\"w-4 h-4 text-white\" />\n      </div>\n      <div className=\"bg-gray-100 rounded-2xl rounded-tl-sm px-4 py-3\">\n        <div className=\"flex gap-1\">\n          <span className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"0ms\" }} />\n          <span className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"150ms\" }} />\n          <span className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: \"300ms\" }} />\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// -----------------------------------------------------------------------------\n// Main Component\n// -----------------------------------------------------------------------------\n\nexport default function CreateSOPPage() {\n  const router = useRouter()\n  const { addSOP, session, startNewSession, addSessionNotes, setSessionPhase } = useSOPContext()\n\n  // Local state\n  const [notes, setNotes] = useState<Note[]>([])\n  const [currentPhase, setCurrentPhase] = useState<ConversationPhase>(\"foundation\")\n  const [progress, setProgress] = useState(0)\n  const [activeTab, setActiveTab] = useState<\"chat\" | \"notes\">(\"chat\")\n  const [messageCount, setMessageCount] = useState(0)\n  const [inputValue, setInputValue] = useState(\"\")\n\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n\n  // Initialize session on mount\n  useEffect(() => {\n    if (!session) {\n      startNewSession()\n    }\n  }, [session, startNewSession])\n\n  // -------------------------------------------------------------------------\n  // Chat Hook Configuration (v5 API)\n  // -------------------------------------------------------------------------\n\n  const { messages, sendMessage, status } = useChat({\n    transport: new DefaultChatTransport({\n      api: \"/api/chat/sop\",\n    }),\n    onFinish: ({ message }) => {\n      // Parse the AI response and extract notes\n      const newMessageCount = messageCount + 1\n      setMessageCount(newMessageCount)\n\n      // Get text content from parts\n      const content = getMessageText(message.parts)\n      const parsed = parseAIResponse(content, newMessageCount)\n\n      // Add extracted notes\n      if (parsed.notes.length > 0) {\n        setNotes((prev) => [...prev, ...parsed.notes])\n        addSessionNotes(parsed.notes)\n      }\n\n      // Update phase and progress\n      if (parsed.phase) {\n        setCurrentPhase(parsed.phase)\n        setSessionPhase(parsed.phase, parsed.progress)\n      }\n\n      if (typeof parsed.progress === \"number\") {\n        setProgress(parsed.progress)\n      }\n    },\n  })\n\n  const isLoading = status === \"streaming\" || status === \"submitted\"\n\n  // -------------------------------------------------------------------------\n  // Scroll to Bottom\n  // -------------------------------------------------------------------------\n\n  const scrollToBottom = useCallback(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n  }, [])\n\n  useEffect(() => {\n    scrollToBottom()\n  }, [messages, isLoading, scrollToBottom])\n\n  // -------------------------------------------------------------------------\n  // Message Sending (v5 API)\n  // -------------------------------------------------------------------------\n\n  const handleSendMessage = useCallback(() => {\n    if (!inputValue.trim() || isLoading) return\n\n    sendMessage({ text: inputValue.trim() })\n    setInputValue(\"\")\n  }, [inputValue, isLoading, sendMessage])\n\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault()\n        handleSendMessage()\n      }\n    },\n    [handleSendMessage]\n  )\n\n  // -------------------------------------------------------------------------\n  // Actions\n  // -------------------------------------------------------------------------\n\n  const handleSaveDraft = useCallback(() => {\n    // Convert messages to chat history format\n    const chatHistory: ChatMessage[] = messages.map((m) => ({\n      id: m.id,\n      role: m.role === \"assistant\" ? \"ai\" : \"user\",\n      content: getMessageText(m.parts),\n      timestamp: new Date().toISOString(),\n    }))\n\n    const newSOP: SOP = {\n      id: `sop-${Date.now()}`,\n      title: \"New SOP Draft\",\n      department: \"General\",\n      status: \"draft\",\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      content: \"\",\n      notes,\n      chatHistory,\n    }\n    addSOP(newSOP)\n    router.push(\"/dashboard\")\n  }, [notes, messages, addSOP, router])\n\n  const handleReview = useCallback(() => {\n    const sopId = `sop-${Date.now()}`\n\n    // Convert messages to chat history format\n    const chatHistory: ChatMessage[] = messages.map((m) => ({\n      id: m.id,\n      role: m.role === \"assistant\" ? \"ai\" : \"user\",\n      content: getMessageText(m.parts),\n      timestamp: new Date().toISOString(),\n    }))\n\n    const newSOP: SOP = {\n      id: sopId,\n      title: \"New SOP\",\n      department: \"General\",\n      status: \"draft\",\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n      content: \"\",\n      notes,\n      chatHistory,\n    }\n    addSOP(newSOP)\n    router.push(`/review/${sopId}`)\n  }, [notes, messages, addSOP, router])\n\n  const handleDeleteNote = useCallback((id: string) => {\n    setNotes((prev) => prev.filter((n) => n.id !== id))\n  }, [])\n\n  // -------------------------------------------------------------------------\n  // Render\n  // -------------------------------------------------------------------------\n\n  return (\n    <div className=\"min-h-screen bg-slate-50 flex flex-col\">\n      {/* Header */}\n      <header className=\"bg-white border-b border-slate-200 px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Link\n            href=\"/dashboard\"\n            className=\"text-slate-500 hover:text-slate-700 flex items-center gap-2 transition-colors\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n            <span className=\"hidden sm:inline\">Back to Dashboard</span>\n          </Link>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <h1 className=\"text-lg font-semibold text-slate-900 hidden sm:block\">Creating New SOP</h1>\n          <PhaseBadge phase={currentPhase} progress={progress} />\n        </div>\n\n        <Button variant=\"outline\" onClick={handleSaveDraft} className=\"gap-2 bg-white\">\n          <Save className=\"w-4 h-4\" />\n          <span className=\"hidden sm:inline\">Save Draft</span>\n        </Button>\n      </header>\n\n      {/* Mobile Tab Navigation */}\n      <div className=\"lg:hidden flex border-b border-slate-200 bg-white\">\n        <button\n          onClick={() => setActiveTab(\"chat\")}\n          className={cn(\n            \"flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors\",\n            activeTab === \"chat\"\n              ? \"text-blue-600 border-b-2 border-blue-600\"\n              : \"text-slate-500 hover:text-slate-700\"\n          )}\n        >\n          <MessageSquare className=\"w-4 h-4\" />\n          Chat\n        </button>\n        <button\n          onClick={() => setActiveTab(\"notes\")}\n          className={cn(\n            \"flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors\",\n            activeTab === \"notes\"\n              ? \"text-blue-600 border-b-2 border-blue-600\"\n              : \"text-slate-500 hover:text-slate-700\"\n          )}\n        >\n          <FileEdit className=\"w-4 h-4\" />\n          Notes ({notes.length})\n        </button>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex-1 flex overflow-hidden\">\n        {/* Chat Area */}\n        <div\n          className={cn(\n            \"flex-1 flex flex-col bg-white\",\n            activeTab === \"notes\" ? \"hidden lg:flex\" : \"flex\",\n            \"lg:border-r border-slate-200\"\n          )}\n        >\n          {/* Messages */}\n          <div className=\"flex-1 overflow-y-auto p-4 lg:p-6\">\n            {/* Initial greeting (shown before any messages) */}\n            {messages.length === 0 && (\n              <MessageBubble role=\"assistant\" content={INITIAL_GREETING} />\n            )}\n\n            {/* Actual messages */}\n            {messages.map((message) => (\n              <MessageBubble\n                key={message.id}\n                role={message.role as \"user\" | \"assistant\"}\n                content={getMessageText(message.parts)}\n              />\n            ))}\n\n            {/* Loading indicator */}\n            {isLoading && <TypingIndicator />}\n\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Input */}\n          <div className=\"border-t border-gray-200 bg-white p-3 sm:p-4\">\n            <div className=\"flex gap-2 sm:gap-3 items-end\">\n              <textarea\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n                onKeyDown={handleKeyDown}\n                placeholder=\"Type your response here...\"\n                disabled={isLoading}\n                className=\"flex-1 resize-none border border-gray-300 rounded-xl px-4 py-3 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 min-h-[48px] max-h-[120px]\"\n                rows={1}\n              />\n              <Button\n                onClick={handleSendMessage}\n                disabled={!inputValue.trim() || isLoading}\n                className=\"bg-blue-600 hover:bg-blue-700 text-white h-12 w-12 rounded-xl p-0\"\n              >\n                <Send className=\"w-5 h-5\" />\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Notes Panel - Desktop */}\n        <div className=\"w-96 hidden lg:flex flex-col\">\n          <NotesPanel\n            notes={notes}\n            onDeleteNote={handleDeleteNote}\n            onReview={handleReview}\n            progress={progress}\n            phase={currentPhase}\n          />\n        </div>\n\n        {/* Notes Panel - Mobile */}\n        <div className={cn(\"flex-1 lg:hidden\", activeTab === \"chat\" ? \"hidden\" : \"flex flex-col\")}>\n          <NotesPanel\n            notes={notes}\n            onDeleteNote={handleDeleteNote}\n            onReview={handleReview}\n            progress={progress}\n            phase={currentPhase}\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}}]
}